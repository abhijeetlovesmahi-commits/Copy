<script>
    // ... (Firebase config wahi rahega) ...

    let photoBase64 = "";

    // PHOTO COMPRESSION LOGIC
    function previewImage(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = e => {
                const img = new Image();
                img.src = e.target.result;
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    const MAX_WIDTH = 300; // Photo ko chota kar dega
                    const scaleSize = MAX_WIDTH / img.width;
                    canvas.width = MAX_WIDTH;
                    canvas.height = img.height * scaleSize;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    photoBase64 = canvas.toDataURL('image/jpeg', 0.7); // Quality 70%
                    document.getElementById('photoPreview').innerHTML = `<img src="${photoBase64}">`;
                };
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    // Baaki loadRecentStudents aur saveData functions purane wale hi rakhein, 
    // bas dhyan dein ki window.location.href='profile.html?id=${s.uniqueId}' sahi likha ho.
</script>
